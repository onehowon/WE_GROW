<template>
    <div class="main-container">
        
        <!-- [STEP 1] 랜딩 페이지 -->
        <template if:true={isStep1}>
            <div class="step-container fade-in">
                <div class="landing-content">
                    <div class="brand-logo">WE:GROW</div>
                    <h1 class="landing-title">어떤 오피스를<br/>찾고 계신가요?</h1>
                    <p class="landing-desc">AI가 고객님의 니즈를 분석하여<br/>최적의 공간 TOP 3를 추천해 드립니다.</p>
                    
                    <div class="search-box">
                        <input type="text" class="prompt-input" 
                               placeholder="예: 강남역 근처, 20명, 예산 500만원, 채광 좋은 곳" 
                               value={userPrompt}
                               onchange={handlePromptInput}>
                        <button class="btn-search" onclick={goToStep2}>
                            <span>분석 시작</span>
                        </button>
                    </div>
                </div>
            </div>
        </template>

        <!-- [STEP 2] AI 분석 로딩 (애니메이션) -->
        <template if:true={isStep2}>
            <div class="step-container fade-in center-content">
                <div class="ai-loader">
                    <div class="pulse-ring"></div>
                </div>
                <h2 class="loading-text">AI가 최적의 공간을<br/>분석하고 있습니다...</h2>
                <p class="loading-sub">입력하신 조건: <span class="highlight">{userPrompt}</span></p>
            </div>
        </template>

        <!-- [STEP 3] BEST 3 추천 결과 -->
        <template if:true={isStep3}>
            <div class="step-container fade-in">
                <div class="header-simple">
                    <h2>추천 공간 BEST 3</h2>
                    <p>고객님의 조건에 가장 잘 맞는 곳이에요.</p>
                </div>
                <div class="card-list">
                    <template for:each={recommendations} for:item="space">
                        <div key={space.id} class="space-card" onclick={handleCardClick} data-id={space.id}>
                            <div class="card-img" style="background-image: url('https://images.unsplash.com/photo-1497366216548-37526070297c?w=500&q=80');">
                                <span class="badge-match">{space.matchRate}% 일치</span>
                            </div>
                            <div class="card-info">
                                <h3>{space.name}</h3>
                                <p class="loc">{space.location}</p>
                                <div class="tags">
                                    <template for:each={space.tags} for:item="tag">
                                        <span key={tag} class="tag">{tag}</span>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </template>

        <!-- [STEP 4] 상세 페이지 -->
        <template if:true={isStep4}>
            <div class="step-container slide-up">
                <div class="detail-header">
                    <button class="btn-back" onclick={goBackToStep3}>← 뒤로</button>
                    <span class="badge-best">AI 강력 추천</span>
                </div>
                <template if:true={selectedSpace.id}>
                    <div class="detail-hero" style="background-image: url('https://images.unsplash.com/photo-1497366216548-37526070297c?w=500&q=80');"></div>
                    <div class="detail-content">
                        <h1>{selectedSpace.name}</h1>
                        <p class="price">{selectedSpace.price}</p>
                        <hr/>
                        <div class="specs">
                            <div class="spec-item"><strong>면적</strong> {selectedSpace.size}</div>
                            <div class="spec-item"><strong>수용</strong> {selectedSpace.capacity}</div>
                        </div>
                        <div class="features">
                            <h3>주요 특징</h3>
                            <ul>
                                <li>✨ 창가 통유리 구조로 채광 우수</li>
                                <li>🚀 전용 라운지 및 회의실 2개 포함</li>
                                <li>🛡️ 3중 보안 시스템 및 24시간 출입</li>
                            </ul>
                        </div>
                    </div>
                </template>
                <div class="bottom-cta">
                    <button class="btn-primary full-width" onclick={goToStep5}>투어 및 견적 신청하기</button>
                </div>
            </div>
        </template>

        <!-- [STEP 5] 고객 정보 입력 -->
        <template if:true={isStep5}>
            <div class="step-container fade-in">
                <div class="header-simple">
                    <h2>방문자 정보 입력</h2>
                    <p>상세 안내를 위해 연락처를 남겨주세요.</p>
                </div>
                <div class="form-container">
                    <div class="input-group">
                        <label>회사명</label>
                        <input type="text" class="we-input" value={customerInfo.company} data-field="company" onchange={handleInputChange}>
                    </div>
                    <div class="input-group">
                        <label>담당자명</label>
                        <input type="text" class="we-input" value={customerInfo.name} data-field="name" onchange={handleInputChange}>
                    </div>
                    <div class="input-group">
                        <label>연락처</label>
                        <input type="tel" class="we-input" value={customerInfo.phone} data-field="phone" onchange={handleInputChange}>
                    </div>
                    <div class="input-group">
                        <label>이메일</label>
                        <input type="email" class="we-input" value={customerInfo.email} data-field="email" onchange={handleInputChange}>
                    </div>
                </div>
                <div class="bottom-cta">
                    <button class="btn-primary full-width" onclick={goToStep6}>다음 단계로</button>
                </div>
            </div>
        </template>

        <!-- [STEP 6] 후속 액션 선택 -->
        <template if:true={isStep6}>
            <div class="step-container fade-in">
                <div class="header-simple">
                    <h2>어떻게 도와드릴까요?</h2>
                    <p>원하시는 방식을 선택해주세요.</p>
                </div>
                <div class="choice-container">
                    <button class="choice-card" onclick={handleFinalChoice} data-type="email">
                        <div class="icon-circle">📧</div>
                        <h3>이메일로 제안서 받기</h3>
                        <p>상세 견적과 공간 소개서를 메일로 보내드립니다.</p>
                    </button>
                    <button class="choice-card" onclick={handleFinalChoice} data-type="meeting">
                        <div class="icon-circle">📅</div>
                        <h3>담당자와 미팅 잡기</h3>
                        <p>전문 매니저와 투어 일정을 바로 조율합니다.</p>
                    </button>
                </div>
            </div>
        </template>

        <!-- [STEP 7] 접수 완료 -->
        <template if:true={isStep7}>
            <div class="step-container fade-in center-content">
                <div class="success-icon">🎉</div>
                <h1 class="success-title">접수가 완료되었습니다!</h1>
                <p class="success-desc">
                    <strong>{customerInfo.name}</strong> 님, 감사합니다.<br/>
                    <template if:true={isMeeting}>
                        담당자가 <strong>{customerInfo.phone}</strong> 번호로<br/>
                        1시간 이내에 연락드리겠습니다.
                    </template>
                    <template if:false={isMeeting}>
                        <strong>{customerInfo.email}</strong> 주소로<br/>
                        제안서가 발송되었습니다.
                    </template>
                </p>
                <button class="btn-outline" onclick={resetProcess}>처음으로 돌아가기</button>
            </div>
        </template>

    </div>
</template>